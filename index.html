<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<!-- <script scr="script.js" defer></script> -->
	<link rel="stylesheet" href="css/main.css">
	<title>JS2 - l3</title>
</head>
<body>
	<main>
		<section>
			<h1>JS - 2 hw - 3 REGEXP</h1>
			<div>
			<div id="results" style="padding: 15px; box-sizing: border-box;">
			<h3>Regular expression matches: </h3>
				
			</div>
				<form action="#" method="POST" name="validatorform" id="vForm">
				<fieldset>
					<legend>Validation</legend>
					<label for="phoneNumber">Phone numder: </label>
					<input id="phoneNumber" class="inputData" type="text"><br>
					<label for="Email">Email: </label>
					<input id="email" class="inputData" type="email"><br>
					<label for="passport">Passport: </label>
					<input id="passport" class="inputData" type="text"><br>
					<input type="submit" id="send" value="Send">
				</fieldset>
				</form>
			</div>
		</section>
	</main>

	
	<script>	
		console.time('script time');
		
		function main()
		{
			
			//regular expression

			var examples = [
				'<section style="color: #A61300"><p style="color: #4B9500">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Mollitia, <i style="color: #fff">deserunt </i>eius magni veniam distinctio cupiditate earum, dignissimos ipsum id facere voluptatem enim tempore, officiis eligendi corporis labore facilis, reprehenderit? Architecto?</p><div style="color: #6A48D7"></div></section> ',
				'1.5 0 12. 123.4.',
				'09:00, 21-30 333dd-22^33**17:46de33-1133d5:43'
						];


			function regExpTests(examples)
			{
				console.log(examples.length);

				var i = 0, res = [];
				while (i < examples.length) {
					if(res[i] = examples[i].match(/#[0-9A-F]{3,6}/gi)) {
						console.log(res[i].toString());
						showRegExpResult('HTML color: ' + res[i].toString());
					}
					if(res[i] = examples[i].match(/([02468]+)\.?\1?/g)) {
						console.log(res[i].toString());
						showRegExpResult('Even numbers: ' + res[i].toString());
  					}
  					//find time formats - /[0-2](?(?<=2)[0-4]|[0-9])(:|-)[0-5][0-9]/g - In php (PRCE) case it would have worked. But not in javascrip, becasu js regexp doesn't support  conditions like this (?(?<=x)a|b)
  					//
  					if(res[i] = examples[i].match(/[0-2][0-9](:|-)[0-5][0-9]/g)) {
						console.log(res[i].toString());
						showRegExpResult('Time: ' + res[i].toString());
  					}
  					i++;

				}
			}

			function showRegExpResult(result)
			{
				var resultNode = document.createElement('div');
				resultNode.innerHTML = result;
				document.getElementById('results').appendChild(resultNode);
			}
			regExpTests(examples);


			//form 
			function checkData(event)
			{
				var data = {};
				event.stopPropagation();
				event.preventDefault();

				/* bad style:
				data.username = document.getElementById('Username').value;
				data.password = document.getElementById('Password').value;
				data.email = document.getElementById('Email').value;
				data.gender = document.getElementById('Gender').value;
				data.credit_card = document.getElementById('Credit_card').value;
				data.bio = document.getElementById('Bio').value;
				*/

				//good style:
				var formDataArr = [];
				var formDataCol = document.getElementsByClassName('inputData');
		
				for (var i = 0; i < formDataCol.length; i++) {
					formDataArr[i] = formDataCol[i];
				}

				formDataArr.map(function(item) {
					if (validate(item)) {
						if(item.classList.contains('not-match')) {
							item.classList.remove('not-match');
						}
						item.classList.add('match');
					}else {
						if(item.classList.contains('match')) {
							item.classList.remove('match');
						}
						item.classList.add('not-match');
					}
				});

			}

			function validate(item)
			{
				var regEx = '';
				switch(item.id) {
					case 'phoneNumber':
						//format example: +7(952)-333-22-44
						regEx = new RegExp(/^\+7\([0-9]{3}\)-[0-9]{3}-[0-9]{2}-[0-9]{2}$/);
						break;
					case 'email':
						//This is not RFC standart-based rule because RFC supports uggly email names
						// including !#$%&'*+-/=?^_`{}|~ characters
						//format example: mail@mail.ru
						regEx = new RegExp(/^([0-9a-zA-Z\.'"_-])+@[\w-]+\.[\w-]{2,6}$/);
						break;
					case 'passport':
						//format example: 59 36 526856
						regEx = new RegExp(/^\d{2}\s\d{2}\s\d{6}$/);
						break;
				}
				return regEx.test(item.value);
			}

			var submit = document.getElementById('send');
			var phone = document.getElementById('phoneNumber');
			//submit.onclick = addEventListener('click', validate);
			
			//phone.onchange = checkData;
			//setInterval(checkData(), 1000);
			submit.onclick = checkData;
		}

		window.onload = main();
		console.timeEnd('script time');
		
	</script>
</body>
</html>